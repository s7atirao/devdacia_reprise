"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}$(function(){$(".reprise .owl-carousel").owlCarousel({items:5,dots:!0,nav:!1,navText:["&#10094;","&#10095;"],autoplay:!0,loop:!1,autoplayTimeout:7e3,responsive:{0:{items:1,nav:!0,loop:!0},460:{items:2},768:{items:4},860:{items:5,loop:!1}}}),$(".testimonials .owl-carousel").owlCarousel({items:1,dots:!0,nav:!1,navText:["&#10094;","&#10095;"],autoplay:!0,autoplayTimeout:7e3,responsive:{0:{items:1,dots:!0,nav:!1},460:{items:2},768:{items:2,dots:!1,nav:!0}}}),$(".news .owl-carousel").owlCarousel({items:1,dots:!0,autoplay:!0,loop:!0,autoplayTimeout:7e3,responsive:{0:{items:1},520:{items:2},960:{items:3}}}),$(".how-to .accordion__item").on("click",function(){$(".how-to .accordion__item").removeClass("show"),$(this).addClass("show")});var t=[];if(fetch("./data/brands.json").then(function(e){return e.json()}).then(function(e){(t=e.map(function(e){return{name:e.marque,models:e.versions.map(function(e){return e.model})}})).forEach(function(e){$("#marque").append($("<option>").val(e.name).text(e.name))})}).catch(function(e){return console.error(e)}),$("#marque").on("change",function(r){var e=t.find(function(e){return e.name===r.target.value}).models;$("#modele").attr("disabled",!1),document.getElementById("modele").options.length=1,$("#modele option:eq(0)").prop("selected",!0),e.forEach(function(e){$("#modele").append($("<option>").val(e).text(e))})}),$(".form").length){var r=function(){$(".progress__circle").attr("class","progress__circle progress__circle--"+25*n),$(".progress__circle .middle p").text(25*n+"%"),$("#progress-bar").attr("class","step-"+n)},o=function(){n<3&&(a["form"+n].toggleClass("show"),a["form"+(n+1)].toggleClass("show"),$(".forms-wrapper .aos-init").removeClass("aos-init"),$(".forms-wrapper .aos-animate").removeClass("aos-animate"),AOS.refresh(),setTimeout(function(){AOS.init({once:!0,easing:"ease-out"})},100),n++,r())},n=1,a={form1:$("form.step-1"),form2:$("form.step-2"),form3:$("form.step-3")};$(".buttons .submit").on("click",function(e){e.preventDefault(),a["form"+n].submit()}),$(".buttons .back").on("click",function(e){e.preventDefault(),1<n&&(a["form"+n].toggleClass("show"),a["form"+(n-1)].toggleClass("show"),n--,r())});var i={marque:"",modele:"",annee:"",immatriculation:"",kilometrage:"",carburant:"",bav:"",pneus:"",carrosserie:"",propriete:"",nom:"",prenom:"",telephone:"",ville:""};a.form1.validate({rules:{marque:"required",modele:"required"},messages:{marque:"Merci d'indiquer la marque",modele:"Merci d'indiquer le modele"},errorElement:"p",errorPlacement:function(e,r){e.insertAfter($(r).parent())},submitHandler:function(e){i.marque=e.marque.value,i.modele=e.modele.value,o()}});var s=(new Date).getFullYear();[].concat(_toConsumableArray(Array(10))).map(function(e,r){return""+(s-r)}).forEach(function(e){$("#annee").append($("<option>").val(e).text(e))}),a.form2.validate({rules:{annee:"required",kilometrage:"required",carburant:"required",bav:"required"},messages:{annee:"Merci d'indiquer l’année d'immatriculation",kilometrage:"Merci d'indiquer le kilometrage",carburant:"Merci d'indiquer le type de carburant",bav:"Merci d'indiquer votre marque"},errorElement:"p",errorPlacement:function(e,r){"select"===r.attr("data-type")?e.insertAfter($(r).parent()):e.insertAfter(r)},submitHandler:function(e){i.annee=parseInt(e.annee.value),i.kilometrage=parseInt($(".output-kilometrage").text()+"0000"),i.carburant=e.carburant.value,i.bav=e.bav.value,i.pneus=e.pneus.value,i.carrosserie=e.carrosserie.value,i.immatriculation=e.immatriculation.value,o()}}),$.validator.addMethod("custom_phone",function(e){return/^((05)|(06)|(07))[0-9]{8}$/.test(e)},""),a.form3.validate({rules:{propriete:"required",nom:"required",prenom:"required",telephone:{required:{depends:function(){return $(this).val($.trim($(this).val())),!0}},custom_phone:!0},ville:"required",conditions:"required"},messages:{propriete:"",nom:"Merci d'indiquer votre nom",prenom:"Merci d'indiquer votre prénom",telephone:"Merci d'indiquer votre numéro de téléphone",ville:"Merci d'indiquer votre ville",conditions:"Merci d'accepter les conditions générales d'utilisation"},errorElement:"p",highlight:function(e){"checkbox"===$(e).attr("type")?$(e).parents(".form-control").addClass("error"):$(e).addClass("error")},unhighlight:function(e){"checkbox"===$(e).attr("type")?$(e).parents(".form-control").removeClass("error"):$(e).removeClass("error")},submitHandler:function(e){i.nom=e.nom.value,i.prenom=e.prenom.value,i.telephone=e.telephone.value,i.ville=e.ville.value,i.propriete="oui"===e.propriete.value,$(".form.step-3 .buttons").hide(),fetch("./send.php",{method:"POST",body:JSON.stringify(i)}).then(function(e){200===e.status||201===e.status?(a["form"+n].toggleClass("show"),$(".confirm").toggleClass("show"),$(".confirm").removeClass("aos-init").removeClass("aos-animate"),AOS.refresh(),setTimeout(function(){AOS.init({once:!0,easing:"ease-out"})},100),n++,r()):($(".form.step-3 .buttons").show(),$(".form.step-3 .form-error").show())}).catch(function(e){$(".form.step-3 .buttons").show(),$(".form.step-3 .form-error").show(),console.error(e)})}})}$(".faq li.q").on("click",function(){$(this).next().slideToggle("500").siblings("li.a").slideUp()}),$(".kilometrage").length&&$(".kilometrage").createSlide({output:".output-kilometrage",firstvalue:1,maxvalue:16})});